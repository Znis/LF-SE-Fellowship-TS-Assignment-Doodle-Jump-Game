var G=Object.defineProperty;var V=(e,i,d)=>i in e?G(e,i,{enumerable:!0,configurable:!0,writable:!0,value:d}):e[i]=d;var s=(e,i,d)=>(V(e,typeof i!="symbol"?i+"":i,d),d);(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))g(l);new MutationObserver(l=>{for(const h of l)if(h.type==="childList")for(const S of h.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&g(S)}).observe(document,{childList:!0,subtree:!0});function d(l){const h={};return l.integrity&&(h.integrity=l.integrity),l.referrerPolicy&&(h.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?h.credentials="include":l.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function g(l){if(l.ep)return;l.ep=!0;const h=d(l);fetch(l.href,h)}})();const a={CANVAS_HEIGHT:450,CANVAS_WIDTH:300},H=50,p=50,I=12,A=40,F=40,b=40,x=8,E=8;class f{constructor(i,d){s(this,"x");s(this,"y");s(this,"distance",i=>Math.sqrt((i.x-this.x)**2+(i.y-this.y)**2));this.x=i,this.y=d}}function C(e,i){return e+Math.floor((i-e)*Math.random())}class y{constructor(i,d,g,l){s(this,"startPoint");s(this,"h");s(this,"w");s(this,"imagePath");s(this,"image");s(this,"move");s(this,"dx");this.startPoint=i,this.h=d,this.w=g,this.move=C(0,4)<1,this.dx=1,this.image=new Image,this.imagePath=l,this.image.src=this.imagePath}movePlatform(){this.move&&(this.startPoint.x+=this.dx,(this.startPoint.x+this.w>=a.CANVAS_WIDTH||this.startPoint.x<=0)&&(this.dx*=-1))}}var c=(e=>(e.welcomeScreen="welcomeScreen",e.initialisation="initialisation",e.running="running",e.paused="paused",e.resume="resume",e.gameOver="gameOver",e.restart="restart",e))(c||{});const P={right:"./assets/images/doodler-right.png",left:"./assets/images/doodler-left.png"};var u=(e=>(e.right="right",e.left="left",e))(u||{});const t={doodler:{},gameState:"welcomeScreen",score:0,highScore:0,platformArray:[],reqAnimFrame:0,gameOverTransition:150,jetAnimIdx:0,powerArray:[]},r={doodlerDir:"right",onGround:!0,onPlatform:!1,distanceFromGround:0,gravity:.4,currentPlatform:new y(new f(0,a.CANVAS_HEIGHT),10,a.CANVAS_WIDTH,""),dy:0,dx:0,fallDistance:500,hasPower:!1};class R{constructor(i,d,g,l){s(this,"startPoint");s(this,"h");s(this,"w");s(this,"imagePath");s(this,"direction");s(this,"image");this.startPoint=i,this.h=d,this.w=g,this.image=new Image,this.direction=l,this.imagePath=this.direction==u.right?P.right:P.left,this.image.src=this.imagePath,console.log(this.imagePath)}updateDoodler(){this.direction=r.doodlerDir,this.imagePath=this.direction==u.right?P.right:P.left,this.image.src=this.imagePath}}class W{constructor(i,d,g,l){s(this,"startPoint");s(this,"h");s(this,"w");s(this,"imagePath");s(this,"image");this.startPoint=i,this.h=d,this.w=g,this.image=new Image,this.imagePath=l,this.image.src=this.imagePath}}function k(){t.doodler=new R(new f(a.CANVAS_WIDTH/2-p,a.CANVAS_HEIGHT-H),H,p,u.right)}function L(){let e=a.CANVAS_HEIGHT-50;for(;e>0;){let i=Math.floor(Math.random()*(a.CANVAS_WIDTH-A)*4/5);const d=new y(new f(C(0,i),e),I,A,"./assets/images/platform.png");t.platformArray.push(d),e-=50}}function q(){let e=Math.floor(Math.random()*(a.CANVAS_WIDTH-A)*4/5);if(Math.random()<.1){const d=new W(new f(e,-40),F,b,"./assets/images/jetpack.png");t.powerArray.push(d)}const i=new y(new f(e,0),I,A,"./assets/images/platform.png");t.platformArray.unshift(i)}function M(){console.log(r.distanceFromGround),r.distanceFromGround>a.CANVAS_HEIGHT&&t.platformArray.forEach(e=>{e.movePlatform()})}function j(){const e=t.doodler.startPoint.y-a.CANVAS_HEIGHT/2;e<0&&(t.doodler.startPoint.y-=e,t.platformArray.forEach(i=>{i.startPoint.y-=e}),t.powerArray.forEach(i=>{i.startPoint.y-=e}),r.currentPlatform.startPoint.y-=e,t.platformArray[0].startPoint.y>50&&(q(),t.score++,t.highScore=Math.max(t.highScore,t.score),r.distanceFromGround+=50))}function _(e,i){return e.startPoint.x<i.startPoint.x+i.w&&e.startPoint.x+e.w>i.startPoint.x&&e.startPoint.y<i.startPoint.y+i.h&&e.startPoint.y+e.h>i.startPoint.y}function X(){t.doodler.startPoint.x+=r.dx,r.dx>0&&(r.dx-=.4),r.dx<0&&(r.dx+=.4)}function $(){t.platformArray.forEach(e=>{_(t.doodler,e)&&r.dy>=0&&(t.doodler.startPoint.y=e.startPoint.y-t.doodler.h,r.currentPlatform=e,r.onPlatform=!0,r.onGround=!1,r.dy=-x)})}function D(){r.hasPower&&(r.dy=-x),r.dy+=r.gravity,t.doodler.startPoint.y+=r.dy,t.doodler.startPoint.y>=a.CANVAS_HEIGHT-t.doodler.h&&r.onGround&&(r.dy=-x),r.onPlatform=t.doodler.startPoint.x<r.currentPlatform.startPoint.x+r.currentPlatform.w&&t.doodler.startPoint.x+t.doodler.w>r.currentPlatform.startPoint.x&&r.currentPlatform.startPoint.y<=a.CANVAS_HEIGHT,t.doodler.startPoint.y+t.doodler.h-r.gravity*2>=a.CANVAS_HEIGHT&&Y(),t.doodler.startPoint.y<a.CANVAS_HEIGHT/2&&r.onPlatform}function B(){t.doodler.startPoint.x>a.CANVAS_WIDTH?t.doodler.startPoint.x=0:r.dx=E,r.doodlerDir=u.right,t.doodler.updateDoodler()}function J(){t.doodler.startPoint.x+t.doodler.w<0?t.doodler.startPoint.x=a.CANVAS_WIDTH-t.doodler.w:r.dx=-E,r.doodlerDir=u.left,t.doodler.updateDoodler()}function N(){t.gameState=c.initialisation,k(),L(),requestAnimationFrame(w)}function K(){t.gameState=c.running}function Y(){t.gameState=c.gameOver}function z(){t.powerArray.forEach(e=>{_(t.doodler,e)&&(r.hasPower||Q())})}function Q(){r.hasPower=!0;const e=setTimeout(()=>{clearTimeout(e),r.hasPower=!1},4e3)}function U(){if(r.fallDistance>0){const e=t.doodler.startPoint.y-a.CANVAS_HEIGHT/2;t.platformArray.forEach(i=>{i.startPoint.y-=e}),t.powerArray.forEach(i=>{i.startPoint.y-=e}),r.currentPlatform.startPoint.y-=e,t.doodler.startPoint.y-=e,t.doodler.startPoint.y+=5,r.fallDistance-=5}else t.gameOverTransition>0?T(t.gameOverTransition-=4):T(0),t.doodler.startPoint.y<a.CANVAS_HEIGHT&&(t.doodler.startPoint.y+=4)}function Z(){t.gameState==c.running&&(t.gameState=c.paused,cancelAnimationFrame(t.reqAnimFrame),it())}function O(){t.gameState==c.paused&&(t.gameState=c.running,requestAnimationFrame(w))}function tt(){t.score=0,r.currentPlatform=new y(new f(0,a.CANVAS_HEIGHT),10,a.CANVAS_WIDTH,""),r.distanceFromGround=0,r.onPlatform=!1,r.onGround=!0,r.dx=0,r.dy=0,r.fallDistance=400,t.gameOverTransition=150,t.platformArray=[],t.gameState=c.initialisation,cancelAnimationFrame(t.reqAnimFrame),N()}const et="/LF-SE-Fellowship-TS-Assignment-Doodle-Jump-Game/assets/images/jetSheet.png",v=new Image;v.src=et;const m={sprite:v,width:17,height:54,position:[new f(39,128),new f(8,0),new f(39,0),new f(71,0),new f(104,0),new f(8,64),new f(39,64),new f(71,64),new f(104,64),new f(8,128)]},n=document.querySelector("#gameCanvas"),o=n.getContext("2d");n.width=a.CANVAS_WIDTH;n.height=a.CANVAS_HEIGHT;function ot(){n.style.display="block",o.clearRect(0,0,a.CANVAS_WIDTH,a.CANVAS_HEIGHT),o.fillStyle="#f7efe7",o.fillRect(0,0,a.CANVAS_WIDTH,a.CANVAS_HEIGHT);for(let e=0;e<a.CANVAS_WIDTH;e+=20)o.beginPath(),o.moveTo(e,0),o.lineTo(e,a.CANVAS_HEIGHT),o.strokeStyle="#efdbc6",o.stroke();for(let e=0;e<a.CANVAS_HEIGHT;e+=20)o.beginPath(),o.moveTo(0,e),o.lineTo(a.CANVAS_HEIGHT,e),o.strokeStyle="#efdbc6",o.stroke();t.platformArray.forEach(e=>{o.beginPath(),o.drawImage(e.image,e.startPoint.x,e.startPoint.y,e.w,e.h)}),r.hasPower||t.powerArray.forEach(e=>{o.drawImage(e.image,e.startPoint.x,e.startPoint.y,e.w,e.h)}),r.hasPower&&(t.jetAnimIdx<9?t.jetAnimIdx++:t.jetAnimIdx=0,r.doodlerDir==u.right?o.drawImage(m.sprite,m.position[t.jetAnimIdx].x,m.position[t.jetAnimIdx].y,m.width,m.height,t.doodler.startPoint.x-14,t.doodler.startPoint.y+10,20,50):o.drawImage(m.sprite,m.position[t.jetAnimIdx].x,m.position[t.jetAnimIdx].y,m.width,m.height,t.doodler.startPoint.x+p-5,t.doodler.startPoint.y+10,20,50)),rt(),o.beginPath(),o.drawImage(t.doodler.image,t.doodler.startPoint.x,t.doodler.startPoint.y,t.doodler.w,t.doodler.h)}n.addEventListener("click",()=>{t.gameState==c.gameOver&&tt(),t.gameState==c.paused&&O()});function rt(){o.font="24px Outfit",o.fillStyle="#fff",o.fillText("Score: "+t.score,50,30)}function T(e){o.fillStyle="rgba(0, 0, 0, 0.7)",o.fillRect(0,n.height+e,n.width,n.height),o.font="32px Outfit",o.fillStyle="#ff0000",o.fillText("Game Over",n.width/2-10,n.height+(e-150)),o.font="32px Outfit",o.fillText(`Score: ${t.score}`,n.width/2-5,n.height+(e-100)),o.font="20px Outfit",o.fillText(`High Score: ${t.highScore}`,n.width/2-5,n.height+(e-50)),o.font="18px Outfit",o.fillText("Click to Restart",n.width/2-10,n.height+(e-10))}function it(){o.fillStyle="rgba(0, 0, 0, 0.7)",o.fillRect(0,0,n.width,n.height),o.font="48px Outfit",o.fillStyle="orange",o.fillText("Game Paused",n.width/2-130,n.height/2-50),o.font="32px Outfit",o.fillText(`Score: ${t.score}`,n.width/2-100,n.height/2+10),o.font="26px Outfit",o.fillText(`High Score: ${t.highScore}`,n.width/2-100,n.height/2+70),o.font="24px Outfit",o.fillText("Click to Resume",n.width/2-100,n.height/2+140)}function at(){o.font="20px Arial",o.fillStyle="black",o.textAlign="center",o.fillText("Press Space to Start",n.width/2,n.height-60)}window.addEventListener("keydown",e=>{switch(e.key){case"w":{D();break}case"d":{B();break}case"a":{J();break}case"e":{t.gameState==c.initialisation&&K();break}case"q":{t.gameState==c.running?Z():t.gameState==c.paused&&O();break}}});const nt=document.querySelector("#info-screen"),st=document.querySelector("#enter-btn");st.addEventListener("click",()=>{nt.style.display="none",t.gameState=c.initialisation,N()});function w(){t.reqAnimFrame=requestAnimationFrame(w),ot(),t.gameState==c.initialisation?at():t.gameState==c.running?(D(),X(),j(),M(),$(),z()):t.gameState==c.gameOver&&(U(),t.highScore=t.score>t.highScore?t.score:t.highScore)}t.gameState!=c.welcomeScreen&&requestAnimationFrame(w);
