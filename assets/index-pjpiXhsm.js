var V=Object.defineProperty;var k=(e,o,c)=>o in e?V(e,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):e[o]=c;var s=(e,o,c)=>(k(e,typeof o!="symbol"?o+"":o,c),c);(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))g(l);new MutationObserver(l=>{for(const f of l)if(f.type==="childList")for(const w of f.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&g(w)}).observe(document,{childList:!0,subtree:!0});function c(l){const f={};return l.integrity&&(f.integrity=l.integrity),l.referrerPolicy&&(f.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?f.credentials="include":l.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function g(l){if(l.ep)return;l.ep=!0;const f=c(l);fetch(l.href,f)}})();const n={CANVAS_HEIGHT:450,CANVAS_WIDTH:300},I=50,p=50,E=12,A=40,F=40,R=40,x=10,O=8;var d=(e=>(e.welcomeScreen="welcomeScreen",e.initialisation="initialisation",e.running="running",e.paused="paused",e.resume="resume",e.gameOver="gameOver",e.restart="restart",e))(d||{});const y={right:"./assets/images/doodler-right.png",left:"./assets/images/doodler-left.png"};var u=(e=>(e.right="right",e.left="left",e))(u||{}),P=(e=>(e.flexible="flexible",e.broken="broken",e))(P||{});const t={doodler:{},gameState:"welcomeScreen",score:0,highScore:0,platformArray:[],reqAnimFrame:0,gameOverTransition:150,jetAnimIdx:0,powerArray:[]},r={doodlerDir:"right",onGround:!0,onPlatform:!1,distanceFromGround:0,gravity:.4,dy:0,dx:0,fallDistance:500,hasPower:!1};class L{constructor(o,c,g,l){s(this,"startPoint");s(this,"h");s(this,"w");s(this,"imagePath");s(this,"direction");s(this,"image");this.startPoint=o,this.h=c,this.w=g,this.image=new Image,this.direction=l,this.imagePath=this.direction==u.right?y.right:y.left,this.image.src=this.imagePath,console.log(this.imagePath)}updateDoodler(){this.direction=r.doodlerDir,this.imagePath=this.direction==u.right?y.right:y.left,this.image.src=this.imagePath}}class h{constructor(o,c){s(this,"x");s(this,"y");s(this,"distance",o=>Math.sqrt((o.x-this.x)**2+(o.y-this.y)**2));this.x=o,this.y=c}}function v(e,o){return e+Math.floor((o-e)*Math.random())}class D{constructor(o,c,g,l){s(this,"startPoint");s(this,"h");s(this,"w");s(this,"imagePath");s(this,"image");s(this,"type");s(this,"move");s(this,"dx");this.startPoint=o,this.h=c,this.w=g,this.move=v(0,4)<1,this.dx=1,this.type=this.assignType(),this.image=new Image,this.imagePath=this.assignImgSrc()||l,this.image.src=this.imagePath}assignType(){return Math.random()<.1?P.broken:P.flexible}assignImgSrc(){if(this.type==P.flexible)return"./assets/images/platform-flexible.png";if(this.type==P.broken)return"./assets/images/platform-broken.png"}movePlatform(){this.move&&(this.startPoint.x+=this.dx,(this.startPoint.x+this.w>=n.CANVAS_WIDTH||this.startPoint.x<=0)&&(this.dx*=-1))}}class W{constructor(o,c,g,l){s(this,"startPoint");s(this,"h");s(this,"w");s(this,"imagePath");s(this,"image");this.startPoint=o,this.h=c,this.w=g,this.image=new Image,this.imagePath=l,this.image.src=this.imagePath}}function M(){t.doodler=new L(new h(n.CANVAS_WIDTH/2-p,n.CANVAS_HEIGHT-I),I,p,u.right)}function q(){let e=n.CANVAS_HEIGHT-50;for(;e>0;){let o=Math.floor(Math.random()*(n.CANVAS_WIDTH-A)*4/5);const c=new D(new h(v(0,o),e),E,A,"./assets/images/platform.png");t.platformArray.push(c),e-=40}}function j(){let e=Math.floor(Math.random()*(n.CANVAS_WIDTH-A)*4/5);if(Math.random()<.04){const c=new W(new h(e,-40),F,R,"./assets/images/jetpack.png");t.powerArray.push(c)}const o=new D(new h(e,0),E,A,"./assets/images/platform.png");t.platformArray.unshift(o)}function X(){console.log(r.distanceFromGround),r.distanceFromGround>n.CANVAS_HEIGHT&&t.platformArray.forEach(e=>{e.movePlatform()})}function $(){const e=t.doodler.startPoint.y-n.CANVAS_HEIGHT/2;e<0&&(t.doodler.startPoint.y-=e,t.platformArray.forEach(o=>{o.startPoint.y-=e}),t.powerArray.forEach(o=>{o.startPoint.y-=e}),t.platformArray[0].startPoint.y>40&&(j(),t.score++,t.highScore=Math.max(t.highScore,t.score),r.distanceFromGround+=40))}function C(e,o){return e.startPoint.x<o.startPoint.x+o.w&&e.startPoint.x+e.w>o.startPoint.x&&e.startPoint.y<o.startPoint.y+o.h&&e.startPoint.y+e.h>o.startPoint.y}function B(){t.doodler.startPoint.x+=r.dx,r.dx>0&&(r.dx-=.4),r.dx<0&&(r.dx+=.4)}function J(){t.platformArray.forEach(e=>{C(t.doodler,e)&&r.dy>=0&&e.type==P.flexible&&(t.doodler.startPoint.y=e.startPoint.y-t.doodler.h,r.onPlatform=!0,r.onGround=!1,r.dy=-x)})}function _(){r.hasPower&&(r.dy=-x),r.dy+=r.gravity,t.doodler.startPoint.y+=r.dy,t.doodler.startPoint.y>=n.CANVAS_HEIGHT-t.doodler.h&&r.onGround&&(r.dy=-x),t.doodler.startPoint.y+t.doodler.h-r.gravity*2>=n.CANVAS_HEIGHT&&Q(),t.doodler.startPoint.y<n.CANVAS_HEIGHT/2&&r.onPlatform}function K(){t.doodler.startPoint.x>n.CANVAS_WIDTH?t.doodler.startPoint.x=0:r.dx=O,r.doodlerDir=u.right,t.doodler.updateDoodler()}function Y(){t.doodler.startPoint.x+t.doodler.w<0?t.doodler.startPoint.x=n.CANVAS_WIDTH-t.doodler.w:r.dx=-O,r.doodlerDir=u.left,t.doodler.updateDoodler()}function N(){t.gameState=d.initialisation,M(),q(),requestAnimationFrame(S)}function z(){t.gameState=d.running}function Q(){t.gameState=d.gameOver}function U(){t.powerArray.forEach(e=>{C(t.doodler,e)&&(r.hasPower||Z())})}function Z(){r.hasPower=!0;const e=setTimeout(()=>{clearTimeout(e),r.hasPower=!1},4e3)}function tt(){if(r.fallDistance>0){const e=t.doodler.startPoint.y-n.CANVAS_HEIGHT/2;t.platformArray.forEach(o=>{o.startPoint.y-=e}),t.powerArray.forEach(o=>{o.startPoint.y-=e}),t.doodler.startPoint.y-=e,t.doodler.startPoint.y+=5,r.fallDistance-=5}else t.gameOverTransition>0?H(t.gameOverTransition-=4):H(0),t.doodler.startPoint.y<n.CANVAS_HEIGHT&&(t.doodler.startPoint.y+=4)}function et(){t.gameState==d.running&&(t.gameState=d.paused,cancelAnimationFrame(t.reqAnimFrame),at())}function T(){t.gameState==d.paused&&(t.gameState=d.running,requestAnimationFrame(S))}function G(){t.score=0,r.distanceFromGround=0,r.onPlatform=!1,r.onGround=!0,r.dx=0,r.dy=0,r.fallDistance=400,t.gameOverTransition=150,t.platformArray=[],t.gameState=d.initialisation,cancelAnimationFrame(t.reqAnimFrame),N()}const it="/LF-SE-Fellowship-TS-Assignment-Doodle-Jump-Game/assets/images/jetSheet.png",b=new Image;b.src=it;const m={sprite:b,width:17,height:54,position:[new h(39,128),new h(8,0),new h(39,0),new h(71,0),new h(104,0),new h(8,64),new h(39,64),new h(71,64),new h(104,64),new h(8,128)]},a=document.querySelector("#gameCanvas"),i=a.getContext("2d");a.width=n.CANVAS_WIDTH;a.height=n.CANVAS_HEIGHT;function ot(){a.style.display="block",i.clearRect(0,0,n.CANVAS_WIDTH,n.CANVAS_HEIGHT),i.fillStyle="#f7efe7",i.fillRect(0,0,n.CANVAS_WIDTH,n.CANVAS_HEIGHT);for(let e=0;e<n.CANVAS_WIDTH;e+=20)i.beginPath(),i.moveTo(e,0),i.lineTo(e,n.CANVAS_HEIGHT),i.strokeStyle="#efdbc6",i.stroke();for(let e=0;e<n.CANVAS_HEIGHT;e+=20)i.beginPath(),i.moveTo(0,e),i.lineTo(n.CANVAS_HEIGHT,e),i.strokeStyle="#efdbc6",i.stroke();t.platformArray.forEach(e=>{i.beginPath(),i.drawImage(e.image,e.startPoint.x,e.startPoint.y,e.w,e.h)}),r.hasPower||t.powerArray.forEach(e=>{i.drawImage(e.image,e.startPoint.x,e.startPoint.y,e.w,e.h)}),r.hasPower&&(t.jetAnimIdx<9?t.jetAnimIdx++:t.jetAnimIdx=0,r.doodlerDir==u.right?i.drawImage(m.sprite,m.position[t.jetAnimIdx].x,m.position[t.jetAnimIdx].y,m.width,m.height,t.doodler.startPoint.x-14,t.doodler.startPoint.y+10,20,50):i.drawImage(m.sprite,m.position[t.jetAnimIdx].x,m.position[t.jetAnimIdx].y,m.width,m.height,t.doodler.startPoint.x+p-5,t.doodler.startPoint.y+10,20,50)),rt(),i.beginPath(),i.drawImage(t.doodler.image,t.doodler.startPoint.x,t.doodler.startPoint.y,t.doodler.w,t.doodler.h)}a.addEventListener("click",()=>{t.gameState==d.gameOver&&G(),t.gameState==d.paused&&T()});function rt(){i.font="24px Outfit",i.fillStyle="#fff",i.fillText("Score: "+t.score,50,30)}function H(e){i.fillStyle="rgba(0, 0, 0, 0.7)",i.fillRect(0,a.height+e,a.width,a.height),i.font="32px Outfit",i.fillStyle="#ff0000",i.fillText("Game Over",a.width/2-10,a.height+(e-150)),i.font="32px Outfit",i.fillText(`Score: ${t.score}`,a.width/2-5,a.height+(e-100)),i.font="20px Outfit",i.fillText(`High Score: ${t.highScore}`,a.width/2-5,a.height+(e-50)),i.font="18px Outfit",i.fillText("Click to Restart",a.width/2-5,a.height+(e-10))}function at(){i.fillStyle="rgba(0, 0, 0, 0.7)",i.fillRect(0,0,a.width,a.height),i.font="32px Outfit",i.fillStyle="orange",i.fillText("Game Paused",a.width/2-10,a.height/2-50),i.font="24px Outfit",i.fillText(`Score: ${t.score}`,a.width/2-5,a.height/2+10),i.font="20px Outfit",i.fillText(`High Score: ${t.highScore}`,a.width/2-5,a.height/2+70),i.font="18px Outfit",i.fillText("Click to Resume",a.width/2-5,a.height/2+140)}function nt(){i.font="20px Arial",i.fillStyle="black",i.textAlign="center",i.fillText("Press R to Start",a.width/2,a.height-60)}window.addEventListener("keydown",e=>{switch(e.key){case"w":{_();break}case"d":{K();break}case"a":{Y();break}case"r":{t.gameState==d.gameOver&&G(),t.gameState==d.paused&&T(),t.gameState==d.initialisation&&z();break}case"q":{t.gameState==d.running?et():t.gameState==d.paused&&T();break}}});const st=document.querySelector("#info-screen"),lt=document.querySelector("#enter-btn");lt.addEventListener("click",()=>{st.style.display="none",t.gameState=d.initialisation,N()});function S(){t.reqAnimFrame=requestAnimationFrame(S),ot(),t.gameState==d.initialisation?nt():t.gameState==d.running?($(),_(),B(),X(),J(),U()):t.gameState==d.gameOver&&(tt(),t.highScore=t.score>t.highScore?t.score:t.highScore)}t.gameState!=d.welcomeScreen&&requestAnimationFrame(S);
