var b=Object.defineProperty;var k=(e,o,c)=>o in e?b(e,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):e[o]=c;var s=(e,o,c)=>(k(e,typeof o!="symbol"?o+"":o,c),c);(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))g(l);new MutationObserver(l=>{for(const h of l)if(h.type==="childList")for(const p of h.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&g(p)}).observe(document,{childList:!0,subtree:!0});function c(l){const h={};return l.integrity&&(h.integrity=l.integrity),l.referrerPolicy&&(h.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?h.credentials="include":l.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function g(l){if(l.ep)return;l.ep=!0;const h=c(l);fetch(l.href,h)}})();const a={CANVAS_HEIGHT:450,CANVAS_WIDTH:300},I=50,x=50,C=12,y=40,F=40,R=40,T=8,_=8;class f{constructor(o,c){s(this,"x");s(this,"y");s(this,"distance",o=>Math.sqrt((o.x-this.x)**2+(o.y-this.y)**2));this.x=o,this.y=c}}function D(e,o){return e+Math.floor((o-e)*Math.random())}class S{constructor(o,c,g,l){s(this,"startPoint");s(this,"h");s(this,"w");s(this,"imagePath");s(this,"image");s(this,"type");s(this,"move");s(this,"dx");this.startPoint=o,this.h=c,this.w=g,this.move=D(0,4)<1,this.dx=1,this.type=this.assignType(),this.image=new Image,this.imagePath=this.assignImgSrc()||l,this.image.src=this.imagePath}assignType(){return Math.random()<.1?P.broken:P.flexible}assignImgSrc(){if(this.type==P.flexible)return"./assets/images/platform-flexible.png";if(this.type==P.broken)return"./assets/images/platform-broken.png"}movePlatform(){this.move&&(this.startPoint.x+=this.dx,(this.startPoint.x+this.w>=a.CANVAS_WIDTH||this.startPoint.x<=0)&&(this.dx*=-1))}}var d=(e=>(e.welcomeScreen="welcomeScreen",e.initialisation="initialisation",e.running="running",e.paused="paused",e.resume="resume",e.gameOver="gameOver",e.restart="restart",e))(d||{});const A={right:"./assets/images/doodler-right.png",left:"./assets/images/doodler-left.png"};var u=(e=>(e.right="right",e.left="left",e))(u||{}),P=(e=>(e.flexible="flexible",e.broken="broken",e))(P||{});const t={doodler:{},gameState:"welcomeScreen",score:0,highScore:0,platformArray:[],reqAnimFrame:0,gameOverTransition:150,jetAnimIdx:0,powerArray:[]},i={doodlerDir:"right",onGround:!0,onPlatform:!1,distanceFromGround:0,gravity:.4,currentPlatform:new S(new f(0,a.CANVAS_HEIGHT),10,a.CANVAS_WIDTH,""),dy:0,dx:0,fallDistance:500,hasPower:!1};class W{constructor(o,c,g,l){s(this,"startPoint");s(this,"h");s(this,"w");s(this,"imagePath");s(this,"direction");s(this,"image");this.startPoint=o,this.h=c,this.w=g,this.image=new Image,this.direction=l,this.imagePath=this.direction==u.right?A.right:A.left,this.image.src=this.imagePath,console.log(this.imagePath)}updateDoodler(){this.direction=i.doodlerDir,this.imagePath=this.direction==u.right?A.right:A.left,this.image.src=this.imagePath}}class L{constructor(o,c,g,l){s(this,"startPoint");s(this,"h");s(this,"w");s(this,"imagePath");s(this,"image");this.startPoint=o,this.h=c,this.w=g,this.image=new Image,this.imagePath=l,this.image.src=this.imagePath}}function M(){t.doodler=new W(new f(a.CANVAS_WIDTH/2-x,a.CANVAS_HEIGHT-I),I,x,u.right)}function q(){let e=a.CANVAS_HEIGHT-50;for(;e>0;){let o=Math.floor(Math.random()*(a.CANVAS_WIDTH-y)*4/5);const c=new S(new f(D(0,o),e),C,y,"./assets/images/platform.png");t.platformArray.push(c),e-=40}}function j(){let e=Math.floor(Math.random()*(a.CANVAS_WIDTH-y)*4/5);if(Math.random()<.1){const c=new L(new f(e,-40),F,R,"./assets/images/jetpack.png");t.powerArray.push(c)}const o=new S(new f(e,0),C,y,"./assets/images/platform.png");t.platformArray.unshift(o)}function X(){console.log(i.distanceFromGround),i.distanceFromGround>a.CANVAS_HEIGHT&&t.platformArray.forEach(e=>{e.movePlatform()})}function $(){const e=t.doodler.startPoint.y-a.CANVAS_HEIGHT/2;e<0&&(t.doodler.startPoint.y-=e,t.platformArray.forEach(o=>{o.startPoint.y-=e}),t.powerArray.forEach(o=>{o.startPoint.y-=e}),i.currentPlatform.startPoint.y-=e,t.platformArray[0].startPoint.y>40&&(j(),t.score++,t.highScore=Math.max(t.highScore,t.score),i.distanceFromGround+=40))}function N(e,o){return e.startPoint.x<o.startPoint.x+o.w&&e.startPoint.x+e.w>o.startPoint.x&&e.startPoint.y<o.startPoint.y+o.h&&e.startPoint.y+e.h>o.startPoint.y}function B(){t.doodler.startPoint.x+=i.dx,i.dx>0&&(i.dx-=.4),i.dx<0&&(i.dx+=.4)}function J(){t.platformArray.forEach(e=>{N(t.doodler,e)&&i.dy>=0&&e.type==P.flexible&&(t.doodler.startPoint.y=e.startPoint.y-t.doodler.h,i.currentPlatform=e,i.onPlatform=!0,i.onGround=!1,i.dy=-T)})}function O(){i.hasPower&&(i.dy=-T),i.dy+=i.gravity,t.doodler.startPoint.y+=i.dy,t.doodler.startPoint.y>=a.CANVAS_HEIGHT-t.doodler.h&&i.onGround&&(i.dy=-T),i.onPlatform=t.doodler.startPoint.x<i.currentPlatform.startPoint.x+i.currentPlatform.w&&t.doodler.startPoint.x+t.doodler.w>i.currentPlatform.startPoint.x&&i.currentPlatform.startPoint.y<=a.CANVAS_HEIGHT,t.doodler.startPoint.y+t.doodler.h-i.gravity*2>=a.CANVAS_HEIGHT&&Q(),t.doodler.startPoint.y<a.CANVAS_HEIGHT/2&&i.onPlatform}function K(){t.doodler.startPoint.x>a.CANVAS_WIDTH?t.doodler.startPoint.x=0:i.dx=_,i.doodlerDir=u.right,t.doodler.updateDoodler()}function Y(){t.doodler.startPoint.x+t.doodler.w<0?t.doodler.startPoint.x=a.CANVAS_WIDTH-t.doodler.w:i.dx=-_,i.doodlerDir=u.left,t.doodler.updateDoodler()}function v(){t.gameState=d.initialisation,M(),q(),requestAnimationFrame(w)}function z(){t.gameState=d.running}function Q(){t.gameState=d.gameOver}function U(){t.powerArray.forEach(e=>{N(t.doodler,e)&&(i.hasPower||Z())})}function Z(){i.hasPower=!0;const e=setTimeout(()=>{clearTimeout(e),i.hasPower=!1},4e3)}function tt(){if(i.fallDistance>0){const e=t.doodler.startPoint.y-a.CANVAS_HEIGHT/2;t.platformArray.forEach(o=>{o.startPoint.y-=e}),t.powerArray.forEach(o=>{o.startPoint.y-=e}),i.currentPlatform.startPoint.y-=e,t.doodler.startPoint.y-=e,t.doodler.startPoint.y+=5,i.fallDistance-=5}else t.gameOverTransition>0?E(t.gameOverTransition-=4):E(0),t.doodler.startPoint.y<a.CANVAS_HEIGHT&&(t.doodler.startPoint.y+=4)}function et(){t.gameState==d.running&&(t.gameState=d.paused,cancelAnimationFrame(t.reqAnimFrame),at())}function H(){t.gameState==d.paused&&(t.gameState=d.running,requestAnimationFrame(w))}function G(){t.score=0,i.currentPlatform=new S(new f(0,a.CANVAS_HEIGHT),10,a.CANVAS_WIDTH,""),i.distanceFromGround=0,i.onPlatform=!1,i.onGround=!0,i.dx=0,i.dy=0,i.fallDistance=400,t.gameOverTransition=150,t.platformArray=[],t.gameState=d.initialisation,cancelAnimationFrame(t.reqAnimFrame),v()}const rt="/LF-SE-Fellowship-TS-Assignment-Doodle-Jump-Game/assets/images/jetSheet.png",V=new Image;V.src=rt;const m={sprite:V,width:17,height:54,position:[new f(39,128),new f(8,0),new f(39,0),new f(71,0),new f(104,0),new f(8,64),new f(39,64),new f(71,64),new f(104,64),new f(8,128)]},n=document.querySelector("#gameCanvas"),r=n.getContext("2d");n.width=a.CANVAS_WIDTH;n.height=a.CANVAS_HEIGHT;function it(){n.style.display="block",r.clearRect(0,0,a.CANVAS_WIDTH,a.CANVAS_HEIGHT),r.fillStyle="#f7efe7",r.fillRect(0,0,a.CANVAS_WIDTH,a.CANVAS_HEIGHT);for(let e=0;e<a.CANVAS_WIDTH;e+=20)r.beginPath(),r.moveTo(e,0),r.lineTo(e,a.CANVAS_HEIGHT),r.strokeStyle="#efdbc6",r.stroke();for(let e=0;e<a.CANVAS_HEIGHT;e+=20)r.beginPath(),r.moveTo(0,e),r.lineTo(a.CANVAS_HEIGHT,e),r.strokeStyle="#efdbc6",r.stroke();t.platformArray.forEach(e=>{r.beginPath(),r.drawImage(e.image,e.startPoint.x,e.startPoint.y,e.w,e.h)}),i.hasPower||t.powerArray.forEach(e=>{r.drawImage(e.image,e.startPoint.x,e.startPoint.y,e.w,e.h)}),i.hasPower&&(t.jetAnimIdx<9?t.jetAnimIdx++:t.jetAnimIdx=0,i.doodlerDir==u.right?r.drawImage(m.sprite,m.position[t.jetAnimIdx].x,m.position[t.jetAnimIdx].y,m.width,m.height,t.doodler.startPoint.x-14,t.doodler.startPoint.y+10,20,50):r.drawImage(m.sprite,m.position[t.jetAnimIdx].x,m.position[t.jetAnimIdx].y,m.width,m.height,t.doodler.startPoint.x+x-5,t.doodler.startPoint.y+10,20,50)),ot(),r.beginPath(),r.drawImage(t.doodler.image,t.doodler.startPoint.x,t.doodler.startPoint.y,t.doodler.w,t.doodler.h)}n.addEventListener("click",()=>{t.gameState==d.gameOver&&G(),t.gameState==d.paused&&H()});function ot(){r.font="24px Outfit",r.fillStyle="#fff",r.fillText("Score: "+t.score,50,30)}function E(e){r.fillStyle="rgba(0, 0, 0, 0.7)",r.fillRect(0,n.height+e,n.width,n.height),r.font="32px Outfit",r.fillStyle="#ff0000",r.fillText("Game Over",n.width/2-10,n.height+(e-150)),r.font="32px Outfit",r.fillText(`Score: ${t.score}`,n.width/2-5,n.height+(e-100)),r.font="20px Outfit",r.fillText(`High Score: ${t.highScore}`,n.width/2-5,n.height+(e-50)),r.font="18px Outfit",r.fillText("Click to Restart",n.width/2-5,n.height+(e-10))}function at(){r.fillStyle="rgba(0, 0, 0, 0.7)",r.fillRect(0,0,n.width,n.height),r.font="32px Outfit",r.fillStyle="orange",r.fillText("Game Paused",n.width/2-10,n.height/2-50),r.font="24px Outfit",r.fillText(`Score: ${t.score}`,n.width/2-5,n.height/2+10),r.font="20px Outfit",r.fillText(`High Score: ${t.highScore}`,n.width/2-5,n.height/2+70),r.font="18px Outfit",r.fillText("Click to Resume",n.width/2-5,n.height/2+140)}function nt(){r.font="20px Arial",r.fillStyle="black",r.textAlign="center",r.fillText("Press R to Start",n.width/2,n.height-60)}window.addEventListener("keydown",e=>{switch(e.key){case"w":{O();break}case"d":{K();break}case"a":{Y();break}case"r":{t.gameState==d.gameOver&&G(),t.gameState==d.paused&&H(),t.gameState==d.initialisation&&z();break}case"q":{t.gameState==d.running?et():t.gameState==d.paused&&H();break}}});const st=document.querySelector("#info-screen"),lt=document.querySelector("#enter-btn");lt.addEventListener("click",()=>{st.style.display="none",t.gameState=d.initialisation,v()});function w(){t.reqAnimFrame=requestAnimationFrame(w),it(),t.gameState==d.initialisation?nt():t.gameState==d.running?(O(),B(),$(),X(),J(),U()):t.gameState==d.gameOver&&(tt(),t.highScore=t.score>t.highScore?t.score:t.highScore)}t.gameState!=d.welcomeScreen&&requestAnimationFrame(w);
