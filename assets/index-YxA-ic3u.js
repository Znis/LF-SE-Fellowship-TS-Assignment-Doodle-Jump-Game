var D=Object.defineProperty;var v=(e,i,c)=>i in e?D(e,i,{enumerable:!0,configurable:!0,writable:!0,value:c}):e[i]=c;var d=(e,i,c)=>(v(e,typeof i!="symbol"?i+"":i,c),c);(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))h(s);new MutationObserver(s=>{for(const f of s)if(f.type==="childList")for(const y of f.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&h(y)}).observe(document,{childList:!0,subtree:!0});function c(s){const f={};return s.integrity&&(f.integrity=s.integrity),s.referrerPolicy&&(f.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?f.credentials="include":s.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function h(s){if(s.ep)return;s.ep=!0;const f=c(s);fetch(s.href,f)}})();const a={CANVAS_HEIGHT:450,CANVAS_WIDTH:300},H=50,T=50,p=12,P=40,I=8,C=8;class g{constructor(i,c){d(this,"x");d(this,"y");d(this,"distance",i=>Math.sqrt((i.x-this.x)**2+(i.y-this.y)**2));this.x=i,this.y=c}}function x(e,i){return e+Math.floor((i-e)*Math.random())}class A{constructor(i,c,h,s){d(this,"startPoint");d(this,"h");d(this,"w");d(this,"imagePath");d(this,"image");d(this,"move");d(this,"dx");this.startPoint=i,this.h=c,this.w=h,this.move=x(0,4)<1,this.dx=1,this.image=new Image,this.imagePath=s,this.image.src=this.imagePath}movePlatform(){this.move&&(this.startPoint.x+=this.dx,(this.startPoint.x+this.w>=a.CANVAS_WIDTH||this.startPoint.x<=0)&&(this.dx*=-1))}}var l=(e=>(e.welcomeScreen="welcomeScreen",e.initialisation="initialisation",e.running="running",e.paused="paused",e.resume="resume",e.gameOver="gameOver",e.restart="restart",e))(l||{});const u={right:"./assets/images/doodler-right.png",left:"./assets/images/doodler-left.png"};var m=(e=>(e.right="right",e.left="left",e))(m||{});const t={doodler:{},gameState:"welcomeScreen",score:0,highScore:0,platformArray:[],reqAnimFrame:0,gameOverTransition:150},r={doodlerDir:"right",onGround:!0,onPlatform:!1,distanceFromGround:0,gravity:.4,currentPlatform:new A(new g(0,a.CANVAS_HEIGHT),10,a.CANVAS_WIDTH,""),dy:0,dx:0,fallDistance:500};class O{constructor(i,c,h,s){d(this,"startPoint");d(this,"h");d(this,"w");d(this,"imagePath");d(this,"direction");d(this,"image");this.startPoint=i,this.h=c,this.w=h,this.image=new Image,this.direction=s,this.imagePath=this.direction==m.right?u.right:u.left,this.image.src=this.imagePath,console.log(this.imagePath)}updateDoodler(){this.direction=r.doodlerDir,this.imagePath=this.direction==m.right?u.right:u.left,this.image.src=this.imagePath}}function G(){t.doodler=new O(new g(a.CANVAS_WIDTH/2-T,a.CANVAS_HEIGHT-H),H,T,m.right)}function V(){let e=a.CANVAS_HEIGHT-50;for(;e>0;){let i=Math.floor((a.CANVAS_WIDTH-P)*3/4);const c=new A(new g(x(0,i),e),p,P,"./assets/images/platform.png");t.platformArray.push(c),e-=50}}function b(){let e=Math.floor((a.CANVAS_WIDTH-P)*4/5);const i=new A(new g(x(0,e),0),p,P,"./assets/images/platform.png");t.platformArray.unshift(i)}function F(){console.log(r.distanceFromGround),r.distanceFromGround>a.CANVAS_HEIGHT&&t.platformArray.forEach(e=>{e.movePlatform()})}function R(){const e=t.doodler.startPoint.y-a.CANVAS_HEIGHT/2;e<0&&(t.doodler.startPoint.y-=e,t.platformArray.forEach(i=>{i.startPoint.y-=e}),r.currentPlatform.startPoint.y-=e,t.platformArray[0].startPoint.y>50&&(b(),t.score++,t.highScore=Math.max(t.highScore,t.score),r.distanceFromGround+=50))}function L(e,i){return e.startPoint.x<i.startPoint.x+i.w&&e.startPoint.x+e.w>i.startPoint.x&&e.startPoint.y<i.startPoint.y+i.h&&e.startPoint.y+e.h>i.startPoint.y}function W(){t.doodler.startPoint.x+=r.dx,r.dx>0&&(r.dx-=.4),r.dx<0&&(r.dx+=.4)}function k(){t.platformArray.forEach(e=>{L(t.doodler,e)&&r.dy>=0&&(t.doodler.startPoint.y=e.startPoint.y-t.doodler.h,r.currentPlatform=e,r.onPlatform=!0,r.onGround=!1,r.dy=-I)})}function _(){r.dy+=r.gravity,t.doodler.startPoint.y+=r.dy,t.doodler.startPoint.y>=a.CANVAS_HEIGHT-t.doodler.h&&r.onGround&&(r.dy=-I),r.onPlatform=t.doodler.startPoint.x<r.currentPlatform.startPoint.x+r.currentPlatform.w&&t.doodler.startPoint.x+t.doodler.w>r.currentPlatform.startPoint.x&&r.currentPlatform.startPoint.y<=a.CANVAS_HEIGHT,t.doodler.startPoint.y+t.doodler.h-r.gravity*2>=a.CANVAS_HEIGHT&&$(),t.doodler.startPoint.y<a.CANVAS_HEIGHT/2&&r.onPlatform}function q(){t.doodler.startPoint.x>a.CANVAS_WIDTH?t.doodler.startPoint.x=0:r.dx=C,r.doodlerDir=m.right,t.doodler.updateDoodler()}function M(){t.doodler.startPoint.x+t.doodler.w<0?t.doodler.startPoint.x=a.CANVAS_WIDTH-t.doodler.w:r.dx=-C,r.doodlerDir=m.left,t.doodler.updateDoodler()}function E(){t.gameState=l.initialisation,G(),V(),requestAnimationFrame(S)}function X(){t.gameState=l.running}function $(){t.gameState=l.gameOver}function B(){if(r.fallDistance>0){const e=t.doodler.startPoint.y-a.CANVAS_HEIGHT/2;t.platformArray.forEach(i=>{i.startPoint.y-=e}),r.currentPlatform.startPoint.y-=e,t.doodler.startPoint.y-=e,t.doodler.startPoint.y+=5,r.fallDistance-=5}else t.gameOverTransition>0?w(t.gameOverTransition-=4):w(0),t.doodler.startPoint.y<a.CANVAS_HEIGHT&&(t.doodler.startPoint.y+=4)}function J(){t.gameState==l.running&&(t.gameState=l.paused,cancelAnimationFrame(t.reqAnimFrame),z())}function N(){t.gameState==l.paused&&(t.gameState=l.running,requestAnimationFrame(S))}function K(){t.score=0,r.currentPlatform=new A(new g(0,a.CANVAS_HEIGHT),10,a.CANVAS_WIDTH,""),r.distanceFromGround=0,r.onPlatform=!1,r.onGround=!0,r.dx=0,r.dy=0,r.fallDistance=400,t.gameOverTransition=150,t.platformArray=[],t.gameState=l.initialisation,E()}const n=document.querySelector("#gameCanvas"),o=n.getContext("2d");n.width=a.CANVAS_WIDTH;n.height=a.CANVAS_HEIGHT;function Y(){n.style.display="block",o.clearRect(0,0,a.CANVAS_WIDTH,a.CANVAS_HEIGHT),o.fillStyle="#f7efe7",o.fillRect(0,0,a.CANVAS_WIDTH,a.CANVAS_HEIGHT);for(let e=0;e<a.CANVAS_WIDTH;e+=20)o.beginPath(),o.moveTo(e,0),o.lineTo(e,a.CANVAS_HEIGHT),o.strokeStyle="#efdbc6",o.stroke();for(let e=0;e<a.CANVAS_HEIGHT;e+=20)o.beginPath(),o.moveTo(0,e),o.lineTo(a.CANVAS_HEIGHT,e),o.strokeStyle="#efdbc6",o.stroke();t.platformArray.forEach(e=>{o.beginPath(),o.drawImage(e.image,e.startPoint.x,e.startPoint.y,e.w,e.h)}),o.beginPath(),o.drawImage(t.doodler.image,t.doodler.startPoint.x,t.doodler.startPoint.y,t.doodler.w,t.doodler.h),j()}n.addEventListener("click",()=>{t.gameState==l.gameOver&&K(),t.gameState==l.paused&&N()});function j(){o.font="24px Outfit",o.fillStyle="#fff",o.fillText("Score: "+t.score,50,30)}function w(e){o.fillStyle="rgba(0, 0, 0, 0.7)",o.fillRect(0,n.height+e,n.width,n.height),o.font="32px Outfit",o.fillStyle="#ff0000",o.fillText("Game Over",n.width/2-10,n.height+(e-150)),o.font="32px Outfit",o.fillText(`Score: ${t.score}`,n.width/2-5,n.height+(e-100)),o.font="20px Outfit",o.fillText(`High Score: ${t.highScore}`,n.width/2-5,n.height+(e-50)),o.font="18px Outfit",o.fillText("Click to Restart",n.width/2-10,n.height+(e-10))}function z(){o.fillStyle="rgba(0, 0, 0, 0.7)",o.fillRect(0,0,n.width,n.height),o.font="48px Outfit",o.fillStyle="orange",o.fillText("Game Paused",n.width/2-130,n.height/2-50),o.font="32px Outfit",o.fillText(`Score: ${t.score}`,n.width/2-100,n.height/2+10),o.font="26px Outfit",o.fillText(`High Score: ${t.highScore}`,n.width/2-100,n.height/2+70),o.font="24px Outfit",o.fillText("Click to Resume",n.width/2-100,n.height/2+140)}function Q(){o.font="20px Arial",o.fillStyle="black",o.textAlign="center",o.fillText("Press Space to Start",n.width/2,n.height-60)}window.addEventListener("keydown",e=>{switch(e.key){case"w":{_();break}case"d":{q();break}case"a":{M();break}case"e":{t.gameState==l.initialisation&&X();break}case"q":{t.gameState==l.running?J():t.gameState==l.paused&&N();break}}});const U=document.querySelector("#info-screen"),Z=document.querySelector("#enter-btn");Z.addEventListener("click",()=>{U.style.display="none",t.gameState=l.initialisation,E()});function S(){t.reqAnimFrame=requestAnimationFrame(S),Y(),t.gameState==l.initialisation?Q():t.gameState==l.running?(_(),W(),R(),F(),k()):t.gameState==l.gameOver&&(B(),t.highScore=t.score>t.highScore?t.score:t.highScore)}t.gameState!=l.welcomeScreen&&requestAnimationFrame(S);
